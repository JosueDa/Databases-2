kind: pipeline

steps:
  - name: notify
    image: drillster/drone-email
    settings:
      from: josuemorales123@gmail.com
      host: smtp.mailgun.org
      port: 587
      username: postmaster@sandbox3cfdb02ae035466c9810d18605cc9f75.mailgun.org
      password: 21f496baf146cd228c642c7289221c9d-2ac825a1-1c261a67
      recipients:
        - josuemorales123@gmail.com
  - name: UnitTest
    image: maven:3-jdk-11
    commands:
      - mvn package
      - mvn test
  - name: Sonar
    image: maven:3-jdk-11
    commands:
      - mvn clean verify sonar:sonar -Dsonar.login=admin -Dsonar.password=mora456 -Dsonar.host.url=http://52.188.188.66:9000
  - name: QualityGate
    image: maven:3-jdk-11
    commands:
      - mvn clean verify sonar:sonar sonar-quality-gate:check -Dsonar.login=admin -Dsonar.password=mora456 -Dsonar.host.url=http://52.188.188.66:9000
  - name: Production
    image: maven:3-jdk-11
    commands:
      - mvn tomcat7:redeploy